report_comment: >
  This report has been generated by the <a href="https://github.com/OlivierCoen/nf-chimera-detector/" target="_blank">nf-chimera-detector</a>
  analysis pipeline.

report_section_order:
  "nf-chimera-detector-methods-description":
    order: -1000
  software_versions:
    order: -1001
  "nf-chimera-detector-summary":
    order: -1002

export_plots: true

disable_version_detection: true

run_modules:
  - custom_content
  - flash
  - fastp
  - megahit

table_cond_formatting_colours:
  - inverted: "#21B2ED"
  - not_inverted: "#9543E5"

custom_data:
  chimera_families:
    fn: "*_chimeras.csv"
    section_name: "Chimera statistics"
    file_format: "csv"
    sort_rows: false
    description: |
      Statistics distributions of chimeras detected among families
    plot_type: "violin"
    headers:
      family:
        title: "Family"
        description: Family corresponding to the read
        color: "rgb(186,43,32)"
      qlen_1:
        title: "Read length in bp"
        color: "rgb(64, 122, 22)"
      slen_1:
        title: "Subject length (TE) in bp"
        color: "rgb(41, 107, 35)"
      slen_2:
        title: "Subject length (genome) in bp"
        color: "rgb(30, 133, 23)"
      overlap_length:
        title: "Overlap length in bp"
        color: "rgb(36, 173, 93)"
      total_coverage:
        title: "Total coverage of read (TE + genome) in bp"
        color: "rgb(36, 173, 171)"
      coverage_1_only:
        title: "Coverage on TE only in bp"
        color: "rgb(36, 125, 173)"
      coverage_2_only:
        title: "Coverage on genome only in bp"
        color: "rgb(57, 101, 204)"
      pident_1:
        title: "% identity to TE"
        color: "rgb(149, 79, 176)"
      pident_2:
        title: "% identity to genome"
        color: "rgb(132, 21, 158)"
      length_1:
        title: "Alignment length (on TE) in bp"
        color: "rgb(227, 210, 36)"
      length_2:
        title: "Alignment length (on genome) in bp"
        color: "rgb(207, 168, 33)"
      mismatch_1:
        title: "# mismatches (compared to TE)"
        color: "rgb(219, 72, 26)"
      mismatch_2:
        title: "# mismatches (compared to genome)"
        color: "rgb(201, 20, 20)"
      gapopen_1:
        title: "# indels (compared to TE)"
        color: "rgb(30, 148, 64)"
      gapopen_2:
        title: "# indels (compared to genome)"
        color: "rgb(74, 194, 105)"
      evalue_1:
        title: "E-value (on TE)"
        color: "rgb(217, 165, 39)"
      evalue_2:
        title: "E-value (on genome)"
        color: "rgb(163, 149, 23)"
      qstart_1:
        title: "Start position on read (hit on TE)"
        color: "rgb(85, 23, 166)"
      qstart_2:
        title: "Start position on read (hit on genome)"
        color: "rgb(118, 48, 209)"
      qend_1:
        title: "End position on read (hit on TE)"
        color: "rgb(109, 50, 117)"
      qend_2:
        title: "End position on read (hit on genome)"
        color: "rgb(148, 76, 158)"
      sstart_1:
        title: "Start position on TE"
        color: "rgb(62, 97, 194)"
      sstart_2:
        title: "Start position on genome"
        color: "rgb(22, 49, 122)"
      send_1:
        title: "End position on TE"
        color: "rgb(28, 104, 140)"
      send_2:
        title: "End position on genome"
        color: "rgb(10, 77, 110)"

  srr_metadata:
    plot_type: "generalstats"
    headers:
      - family:
          namespace: "SRR metadata"
          title: "Family"
          description: "Family name as provided by the user"
      - srr_id:
          namespace: "SRR metadata"
          title: "SRR ID"
          description: "File accession in NCBI SRA"
      - taxid:
          namespace: "SRR metadata"
          title: "Organism taxon ID"
          description: "Taxon ID of the corresponding organism in NCBI Taxonomy"
      - taxon_name:
          namespace: "SRR metadata"
          title: "Organism name"
          description: "Name of the corresponding organism in NCBI Taxonomy"
      - sra_id:
          namespace: "SRR metadata"
          title: "SRA ID"
          description: "Accession of the corresponding experiment in NCBI SRA"
      - nb_chimeras:
          namespace: "SRR metadata"
          title: "Nb chimeras"
          description: "Number of chimeras found"
          min: 0
          scale: "RdYlGn"
      - coverage:
          namespace: "SRR data"
          title: "Coverage"
          description: "Coverage: total nb of base pairs in read FASTA files divided by the genome length"
          min: 0
          scale: "RdYlGn"
          format: "{:,.0f}"
          suffix: "X"
      - read_fasta_len:
          namespace: "SRR data"
          title: "Read Fasta total size"
          description: "Total number of base pairs in the merged Fasta file"
          min: 0
          scale: "RdYlGn"
      - dl_genome_name:
          namespace: "SRR data"
          title: "Genome name (downloaded)"
          description: "Name of the downloaded genome (if any for the corresponding species)"
      - dl_genome_len:
          namespace: "SRR data"
          title: "Genome length (downloaded)"
          description: "Total number of base pairs in the downloaded genome (if any for the corresponding species)"
          min: 0
          scale: "RdYlGn"
      - asm_genome_len:
          namespace: "SRR data"
          title: "Genome length (assembled)"
          description: "Total number of base pairs in the assembled genome (if not genome was available on NCBI)"
          min: 0
          scale: "RdYlGn"

  fastq_stats:
    plot_type: "generalstats"
    headers:
      - srr_id:
          namespace: "Fastq stats"
          title: "SRR ID"
          description: "File accession in NCBI SRA"
      - num_seqs:
          namespace: "Fastq stats"
          title: "Nb of sequences"
          description: "Number of sequences in Fastq file(s)"
          min: 0
          scale: "RdYlGn"
      - sum_len:
          namespace: "Fastq stats"
          title: "Total nb of base pairs"
          description: "Total nb of base pairs in Fastq file(s)"
          min: 0
          scale: "RdYlGn"
      - min_len:
          namespace: "Fastq stats"
          title: "Min read length"
          description: "Min read length"
          min: 0
          scale: "RdYlGn"
      - avg_len:
          namespace: "Fastq stats"
          title: "Average read length"
          description: "Average read length"
          min: 0
          scale: "RdYlGn"
      - max_len:
          namespace: "Fastq stats"
          title: "Max read length"
          description: "Max read length"
          min: 0
          scale: "RdYlGn"
      - Q1:
          namespace: "Fastq stats"
          title: "Read length - Q1"
          description: "1st quartile of read length distribution"
          min: 0
          scale: "RdYlGn"
      - Q2:
          namespace: "Fastq stats"
          title: "Read length - Q2"
          description: "2nd quartile of read length distribution"
          min: 0
          scale: "RdYlGn"
      - Q3:
          namespace: "Fastq stats"
          title: "Read length - Q3"
          description: "3rd quartile of read length distribution"
          min: 0
          scale: "RdYlGn"
      - sum_gap:
          namespace: "Fastq stats"
          title: "Nb gaps"
          description: "Number of gaps"
          min: 0
          scale: "RdYlGn"
      - N50:
          namespace: "Fastq stats"
          title: "N50"
          description: "Read N50"
          min: 0
          scale: "RdYlGn"
      - N50_num:
          namespace: "Fastq stats"
          title: "L50"
          description: "Read L50"
          min: 0
          scale: "RdYlGn"
      - Q20_pct:
          namespace: "Fastq stats"
          title: "Q20(%)"
          description: "Percentage of bases with the quality score greater than 20"
          min: 0
          scale: "RdYlGn"
      - Q30_pct:
          namespace: "Fastq stats"
          title: "Q30(%)"
          description: "Percentage of bases with the quality score greater than 30"
          min: 0
          scale: "RdYlGn"
      - AvgQual:
          namespace: "Fastq stats"
          title: "average quality"
          description: "Average read quality"
          min: 0
          scale: "RdYlGn"
      - GC_pct:
          namespace: "Fastq stats"
          title: "GC(%)"
          description: "Percentage of GC content"
          min: 0
          scale: "RdYlGn"
      - sum_n:
          namespace: "Fastq stats"
          title: "Nb N"
          description: "Number of ambitious letters (N, n, X, x)"
          min: 0
          scale: "RdYlGn"

  stat_chimeras_per_family:
    section_name: "Mean chimera statistics [family]"
    parent_id: chimera_stat_average
    parent_name: "Averages of chimera statistics"
    parent_description: "Average of various statistics about found chimeras, family per family"
    file_format: "csv"
    sort_rows: false
    description: |
      Mean chimera values, for each family.
    plot_type: "table"
    pconfig:
      col1_header: "Family"
    headers:
      qlen_1:
        title: "Read length"
        description: "Query length (read) in bp"
      slen_1:
        title: "Subject length (TE)"
        description: "Subject length (TE) in bp"
      slen_2:
        title: "Subject length (genome)"
        description: "Subject length (genome) in bp"
      total_coverage:
        title: "Total coverage of read (TE + genome)"
        description: "Total coverage of read (TE + genome) in bp"
      overlap_length:
        title: "Overlap length"
        description: "Overlap length (between TE and genome) in bp"
      coverage_1_only:
        title: "Coverage on TE only in bp"
        description: "Coverage of chimera read on TE only in bp"
      coverage_2_only:
        title: "Coverage on genome only in bp"
        description: "Coverage of chimera read on genome only in bp"
      inverted:
        title: "Inverted orientation?"
        description: "Is the chimera in the same orientation as the sequences?"
      pident_1:
        title: "% identity on TE"
        description: "Percentage of identity (on TE)"
        format: "{:,.1f}"
      pident_2:
        title: "% identity on genome"
        description: "Percentage of identity on genome"
        format: "{:,.1f}"
      length_1:
        title: "Alignment length (on TE) in bp"
      length_2:
        title: "Alignment length (on genome) in bp"
      mismatch_1:
        title: "# mismatches (on TE)"
      mismatch_2:
        title: "# mismatches (on genome)"
      gapopen_1:
        title: "# indels (on TE)"
      gapopen_2:
        title: "# indels (on genome)"
      evalue_1:
        title: "E-value (on TE)"
      evalue_2:
        title: "E-value (on genome)"
      qstart_1:
        title: "Start position on read (hit on TE)"
      qstart_2:
        title: "Start position on read (hit on genome)"
      qend_1:
        title: "End position on read (hit on TE)"
      qend_2:
        title: "End position on read (hit on genome)"
      sstart_1:
        title: "Start position on TE"
      sstart_2:
        title: "Start position on genome"
      send_1:
        title: "End position on TE"
      send_2:
        title: "End position on genome"

  stat_chimeras_per_species:
    section_name: "Mean chimera statistics [species]"
    parent_id: chimera_stat_average
    parent_name: "Averages of chimera statistics"
    parent_description: "Average of various statistics about found chimeras, family per family"
    file_format: "csv"
    sort_rows: false
    description: |
      Mean chimera values, for each species.
    plot_type: "table"
    pconfig:
      col1_header: "Species taxon ID"
    headers:
      qlen_1:
        title: "Read length"
        description: "Query length (read) in bp"
        scale: "Greens"
      slen_1:
        title: "Subject length (TE)"
        description: "Subject length (TE) in bp"
      slen_2:
        title: "Subject length (genome)"
        description: "Subject length (genome) in bp"
      total_coverage:
        title: "Total coverage of read (TE + genome)"
        description: "Total coverage of read (TE + genome) in bp"
      overlap_length:
        title: "Overlap length"
        description: "Overlap length (between TE and genome) in bp"
      coverage_1_only:
        title: "Coverage on TE only in bp"
        description: "Coverage of chimera read on TE only in bp"
      coverage_2_only:
        title: "Coverage on genome only in bp"
        description: "Coverage of chimera read on genome only in bp"
      inverted:
        title: "Inverted orientation?"
        description: "Is the chimera in the same orientation as the sequences?"
      pident_1:
        title: "% identity on TE"
        description: "Percentage of identity (on TE)"
        format: "{:,.1f}"
      pident_2:
        title: "% identity on genome"
        description: "Percentage of identity on genome"
        format: "{:,.1f}"
      length_1:
        title: "Alignment length (on TE) in bp"
      length_2:
        title: "Alignment length (on genome) in bp"
      mismatch_1:
        title: "# mismatches (on TE)"
      mismatch_2:
        title: "# mismatches (on genome)"
      gapopen_1:
        title: "# indels (on TE)"
      gapopen_2:
        title: "# indels (on genome)"
      evalue_1:
        title: "E-value (on TE)"
      evalue_2:
        title: "E-value (on genome)"
      qstart_1:
        title: "Start position on read (hit on TE)"
      qstart_2:
        title: "Start position on read (hit on genome)"
      qend_1:
        title: "End position on read (hit on TE)"
      qend_2:
        title: "End position on read (hit on genome)"
      sstart_1:
        title: "Start position on TE"
      sstart_2:
        title: "Start position on genome"
      send_1:
        title: "End position on TE"
      send_2:
        title: "End position on genome"

  nb_chimeras:
    section_name: "Number of chimeras per family"
    parent_id: family_statistics
    parent_name: "Statistics per family"
    parent_description: "Various distributions computed family by family"
    file_format: "tsv"
    pconfig:
      ylab: family
      sort_samples: true
      colour: "rgb(118, 48, 209)"
      tt_decimals: 0
      logswitch: true
    description: |
      Distribution of the number of chimeras per SRR, family by family
    plot_type: "boxplot"
    color: "rgb(118, 48, 209)"

  nb_srrs_per_family:
    section_name: "Number of SRRs per family"
    parent_id: family_statistics
    parent_name: "Statistics per family"
    parent_description: "Various distributions computed family by family"
    file_format: "tsv"
    pconfig:
      sort_samples: true
      tt_decimals: 0
      logswitch: true
    description: |
      Number of processed SRRs for each family
    plot_type: "barplot"

  nb_species_per_family:
    section_name: "Number of species per family"
    parent_id: family_statistics
    parent_name: "Statistics per family"
    parent_description: "Various distributions computed family by family"
    file_format: "tsv"
    pconfig:
      sort_samples: true
      tt_decimals: 0
      logswitch: true
      cpswitch: false
    description: |
      Number of species found on NCBI for each family
    plot_type: "barplot"

  nb_hits_target:
    section_name: "Number of hits per family [against TEs]"
    parent_id: nb_hits
    parent_name: "Number of Blast hits per family"
    parent_description: "Distributions of number of Blast hits."
    file_format: "tsv"
    pconfig:
      ylab: family
      sort_samples: true
    description: |
      Distribution of the number of Blast hits against the TE database for each SRR, family by family
    plot_type: "boxplot"

  nb_hits_genomes:
    section_name: "Number of hits per family [against genome]"
    parent_id: nb_hits
    parent_name: "Number of Blast hits per family"
    parent_description: "Distributions of number of Blast hits."
    file_format: "tsv"
    pconfig:
      sort_samples: true
    description: |
      Distribution of the number of Blast hits against genome for each SRR, family by family
    plot_type: "boxplot"

  downloaded_genome_size:
    section_name: "Downloaded genomes"
    parent_id: data_size
    parent_name: "Data size"
    parent_description: "Data size distributions by family"
    file_format: "tsv"
    pconfig:
      sort_samples: true
    description: |
      Distribution of the size of the downloaded genomes, family by family
    plot_type: "boxplot"

  assembled_genome_size:
    section_name: "Assembled genomes"
    parent_id: data_size
    parent_name: "Data size"
    parent_description: "Data size distributions by family"
    file_format: "tsv"
    pconfig:
      sort_samples: true
    description: |
      Distribution of the size of the assembled genomes, family by family
    plot_type: "boxplot"

  read_fasta_len:
    section_name: "Size of processed SRR read Fasta files (in # bases)"
    parent_id: data_size
    parent_name: "Data size"
    parent_description: "Data size distributions by family"
    file_format: "tsv"
    pconfig:
      sort_samples: true
    description: |
      Distribution of size (in # bases) of the processed SRR read Fasta files, per family
    plot_type: "boxplot"

sp:
  chimera_families:
    fn: "*_chimeras.csv"
  srr_metadata:
    fn: "*srr_metadata.tsv"
  fastq_stats:
    fn: "*fastq_stats.tsv"
  chimeras_overlap_coverage:
    fn: "*_chimeras.csv"
  chimeras_pident:
    fn: "*_chimeras.csv"
  chimeras_aln_length:
    fn: "*_chimeras.csv"
  chimeras_mismatches:
    fn: "*_chimeras.csv"
  chimeras_gapopen:
    fn: "*_chimeras.csv"
  chimeras_qstart:
    fn: "*_chimeras.csv"
  chimeras_qend:
    fn: "*_chimeras.csv"
  chimeras_sstart:
    fn: "*_chimeras.csv"
  chimeras_send:
    fn: "*_chimeras.csv"
  chimeras_evalue:
    fn: "*_chimeras.csv"
  chimeras_qlen:
    fn: "*_chimeras.csv"
  chimeras_slen:
    fn: "*_chimeras.csv"

  stat_chimeras_per_family:
    fn: "*family_chimeras_summary.csv"
  stat_chimeras_per_species:
    fn: "*species_chimeras_summary.csv"
  nb_chimeras:
    fn: "*nb_chimeras_transposed.tsv"
  nb_hits_target:
    fn: "*blast_nb_hits_target_transposed.tsv"
  nb_hits_genomes:
    fn: "*blast_nb_hits_genomes_transposed.tsv"
  downloaded_genome_size:
    fn: "*downloaded_genome_size_transposed.tsv"
  assembled_genome_size:
    fn: "*assembled_genome_size_transposed.tsv"
  read_fasta_len:
    fn: "*read_fasta_len_transposed.tsv"
  nb_srrs_per_family:
    fn: "*nb_srrs_per_family.tsv"
  nb_species_per_family:
    fn: "*nb_species_per_family.tsv"

  flash/hist:
    fn: "*_flash.hist"
  flash/log:
    contents: "[FLASH]"
    fn: "*_flash.log"
